-- 2주차 실습 (2025.03.13)
-- 데이터베이스 선택 (실행 전에 먼저 설정 필요)
USE 한빛무역;

-- 실행할 쿼리 파일을 분리해서 관리 (아래 방식으로 사용 가능)
-- SOURCE queries.sql;


-- 고객 데이터 조회 및 마일리지 인상 계산
SELECT 고객번호,         -- 고객 식별 번호
       담당자명,         -- 고객 담당자 이름
       도시,            -- 고객이 속한 도시
       마일리지 AS 포인트, -- 현재 마일리지 (포인트로 표시)
       마일리지 * 1.1 AS "10% 인상된 마일리지" -- 마일리지 10% 증가 적용
FROM 고객
WHERE 도시 = "서울특별시"  -- 서울특별시 거주 고객만 조회
ORDER BY 마일리지 DESC  -- 마일리지 기준으로 내림차순 정렬 (높은 값부터)
LIMIT 5;  -- 상위 5명의 고객만 출력

/*
✅ LIMIT 사용법 정리
- `LIMIT 5;` → 상위 5개만 출력
- `LIMIT 10, 3;` → 10번째 행부터 3개 출력 (OFFSET 10, 3)
*/

-- DISTINCT를 활용하여 중복된 도시 제거 후 출력
SELECT DISTINCT 도시 -- 중복을 제거한 도시 목록 출력
FROM 고객;
